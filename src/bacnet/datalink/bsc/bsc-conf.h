/**
 * @file
 * @brief Configuration file of BACNet/SC datalink.
 * @author Kirill Neznamov
 * @date August 2022
 * @section LICENSE
 *
 * Copyright (C) 2022 Legrand North America, LLC
 * as an unpublished work.
 *
 * SPDX-License-Identifier: MIT
 */

#ifndef __BSC__CONF__INCLUDED__
#define __BSC__CONF__INCLUDED__

#ifndef BSC_CONF_HUB_CONNECTORS_NUM
#define BSC_CONF_HUB_CONNECTORS_NUM 1
#endif

#ifndef BSC_CONF_HUB_FUNCTIONS_NUM
#define BSC_CONF_HUB_FUNCTIONS_NUM 1
#endif

#ifndef BSC_CONF_NODE_SWITCHES_NUM
#define BSC_CONF_NODE_SWITCHES_NUM 1
#endif

#ifndef BSC_CONF_NODES_NUM
#define BSC_CONF_NODES_NUM 1
#endif

#ifndef BVLC_SC_NPDU_SIZE_CONF
#define BVLC_SC_NPDU_SIZE_CONF 1440
#endif

// THIS should not be changed, most of BACNet/SC devices must have
// hub connector, it uses 2 connections
#ifndef BSC_CONF_HUB_CONNECTOR_CONNECTIONS_NUM
#define BSC_CONF_HUB_CONNECTOR_CONNECTIONS_NUM (BSC_CONF_HUB_CONNECTORS_NUM*2)
#endif

#ifndef BSC_CONF_HUB_FUNCTION_CONNECTIONS_NUM
#define BSC_CONF_HUB_FUNCTION_CONNECTIONS_NUM (BSC_CONF_HUB_FUNCTIONS_NUM*10)
#endif

#ifndef BSC_CONF_NODE_SWITCH_CONNECTIONS_NUM
#define BSC_CONF_NODE_SWITCH_CONNECTIONS_NUM (BSC_CONF_NODE_SWITCHES_NUM*10)
#endif

// Total amount of client(initiator) webosocket connections
#define BSC_CONF_CLIENT_CONNECTIONS_NUM (BSC_CONF_HUB_CONNECTOR_CONNECTIONS_NUM + BSC_CONF_NODE_SWITCH_CONNECTIONS_NUM)
#define BSC_CONF_SERVER_HUB_CONNECTIONS_MAX_NUM (BSC_CONF_HUB_FUNCTION_CONNECTIONS_NUM)
#define BSC_CONF_SERVER_DIRECT_CONNECTIONS_MAX_NUM  (BSC_CONF_NODE_SWITCH_CONNECTIONS_NUM)
#define BSC_CONF_RX_BUFFER_SIZE 4096
#define BSC_CONF_TX_BUFFER_SIZE 4096

#ifndef BSC_CONF_WSURL_MAX_LEN
#define BSC_CONF_WSURL_MAX_LEN 127
#endif

#ifndef BSC_CONF_NODE_MAX_URI_SIZE_IN_ADDRESS_RESOLUTION_ACK
#define BSC_CONF_NODE_MAX_URI_SIZE_IN_ADDRESS_RESOLUTION_ACK BSC_CONF_WSURL_MAX_LEN
#endif

#ifndef BSC_CONF_NODE_MAX_URIS_NUM_IN_ADDRESS_RESOLUTION_ACK 
#define BSC_CONF_NODE_MAX_URIS_NUM_IN_ADDRESS_RESOLUTION_ACK \
        (BSC_CONF_RX_BUFFER_SIZE/BSC_CONF_NODE_MAX_URI_SIZE_IN_ADDRESS_RESOLUTION_ACK - 1)

#endif

/* Netport custom prperties */
#define PROP_SC_CERTIFICATE_KEY_FILE       PROP_PROPRIETARY_RANGE_MIN
#define PROP_SC_LOCAL_UUID                 (PROP_PROPRIETARY_RANGE_MIN + 1)
#define PROP_SC_HUB_SERVER_PORT            (PROP_PROPRIETARY_RANGE_MIN + 2)
#define PROP_SC_DIRECT_SERVER_PORT         (PROP_PROPRIETARY_RANGE_MIN + 3)

/* Netport constants */
#define SC_NETPORT_BVLC_MAX                     1500
#define SC_NETPORT_NPDU_MAX                     1500
#define SC_NETPORT_CONNECT_TIMEOUT              5
#define SC_NETPORT_HEARTBEAT_TIMEOUT            5
#define SC_NETPORT_DISCONNECT_TIMEOUT           5
#define SC_NETPORT_RECONNECT_TIME               5
#define SC_NETPORT_DIRECT_SERVER_PORT           40000
#define SC_NETPORT_DIRECT_CONNECT_INITIATLE     true
#define SC_NETPORT_DIRECT_CONNECT_ACCERT        true
#define SC_NETPORT_HUB_SERVER_PORT              40001
#define SC_NETPORT_HUB_FUNCTION_ENABLE          true
#ifndef SC_NETPORT_BACFILE_START_INDEX
#define SC_NETPORT_BACFILE_START_INDEX          0
#endif
#ifndef SC_NETPORT_FILES_PER_CONNECT
#define SC_NETPORT_FILES_PER_CONNECT            3
#endif

#define SC_NETPORT_DIRECT_CONNECT_ACCERT_URI  { \
    "SC_Direct_Connect_Accept_URI1",            \
    "SC_Direct_Connect_Accept_URI2",            \
    NULL                                        \
}

#endif